<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session 9e1909e0-2898-4538-b2f4-93c05a3536a5 (2026-01-22 17:22Z) -->

# SOMRIG remote blueprint integration (2026-01-22 17:22Z)

_**User**_

Ive imported a new blueprint for SOMRIG remotes  @hass-config/blueprints/automation/EPMatt/ikea_e2213.yaml a new script needs to be added to @blueprints   to handle it and update @synced-entities.js  @generator.config.js 

---

_**Agent (model claude-4.5-opus-high-thinking, mode Agent)**_

<think><details><summary>Thought Process</summary>
The user wants me to:
1. Add a new blueprint script for the IKEA E2213 (SOMRIG remote) in the `hass-generator/src/blueprints/` folder
2. Update the `synced-entities.js` to handle this new blueprint
3. Update the `generator.config.js` in hass-config

Let me first read the relevant files to understand the structure:
1. The new blueprint YAML file (ikea_e2213.yaml)
2. The existing blueprint scripts (ikea_e2201_base.js, ikea_e2201_dbl_click.js, index.js)
3. The synced-entities.js file
4. The generator.config.js file

Let me start by reading all these files to understand the patterns.</details></think>

---

ðŸ“— Let me read the relevant files to understand the existing patterns and the new blueprint structure.

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** â€¢ Read file: /Users/sharonfrenkel/Dev/hass-config/blueprints/automation/EPMatt/ikea_e2213.yaml</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** â€¢ Read file: /Users/sharonfrenkel/Dev/hass-generator/src/blueprints/ikea_e2201_base.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** â€¢ Read file: /Users/sharonfrenkel/Dev/hass-generator/src/blueprints/ikea_e2201_dbl_click.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** â€¢ Read file: /Users/sharonfrenkel/Dev/hass-generator/src/blueprints/index.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** â€¢ Read file: /Users/sharonfrenkel/Dev/hass-generator/src/generators/synced-entities.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** â€¢ Read file: /Users/sharonfrenkel/Dev/hass-config/generator.config.js</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Now I have a good understanding of the structure. Let me analyze what I need to do:

1. **Create a new blueprint script** `ikea_e2213_base.js` for the SOMRIG remote (E2213)
   - The SOMRIG has two buttons (dots1 and dots2) each with: short, long, release, double actions
   - Looking at the E2201 pattern, I need to create a function that generates the blueprint config
   - The SOMRIG is a shortcut button, so it's likely used for simple actions rather than dimming

2. **Update the blueprints index.js** to export the new blueprint

3. **Update synced-entities.js** if needed - but looking at it, it seems like it handles blueprints generically via the `blueprint` property, so it might not need changes

4. **Update generator.config.js** to import the new blueprint function

Let me think about the SOMRIG blueprint:
- It has buttons: dots1 and dots2
- Each button has: short, long, release, double
- Looking at the YAML, the inputs are:
  - `action_button_dots1_short`, `action_button_dots1_long`, `action_button_dots1_release`, `action_button_dots1_double`
  - `action_button_dots2_short`, `action_button_dots2_long`, `action_button_dots2_release`, `action_button_dots2_double`
  - Loop options: `button_dots1_long_loop`, `button_dots1_long_max_loop_repeats`, `button_dots2_long_loop`, `button_dots2_long_max_loop_repeats`
  - `helper_long_press_delay`

For a base template, I'll create something similar to the RODRET pattern but adapted for the SOMRIG's two buttons (dots1 and dots2).


Looking at the E2201 blueprints, I see there's a basic on/off + dimming variant and a double-click variant. Since the SOMRIG is a shortcut button, I should design it for simple scene or on/off control rather than continuous dimming. I'll map dots1 for activation actions and dots2 for deactivation or alternative scene control.

The E2213 natively supports double press events, which simplifies the implementation compared to the E2201's virtual detection approach. I'll start with a foundational template covering short and long presses for brightness control, then potentially add double-click variants. The base file will handle dots1_short for power on, dots1_long for brightness increase, dots2_short for power off, and dots2_long for brightness decrease, with double presses available for max/min brightness if needed.</details></think>

---

ðŸ¤“ Let me analyze this:

**Plan:**
1. Create `ikea_e2213_base.js` - base template for SOMRIG shortcut button
2. Create `ikea_e2213_dbl_click.js` - template with double-click for max/min brightness
3. Update `blueprints/index.js` to export new functions
4. Update `generator.config.js` to import the new blueprints

The SOMRIG (E2213) has two buttons: dots1 and dots2, each with short/long/release/double actions. It natively supports double-press (unlike E2201 which needs virtual detection).

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** â€¢ Edit file: /Users/sharonfrenkel/Dev/hass-generator/src/blueprints/ikea_e2213_base.js</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** â€¢ Edit file: /Users/sharonfrenkel/Dev/hass-generator/src/blueprints/ikea_e2213_dbl_click.js</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** â€¢ Edit file: /Users/sharonfrenkel/Dev/hass-generator/src/blueprints/index.js</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** â€¢ Edit file: /Users/sharonfrenkel/Dev/hass-config/generator.config.js</summary>

</details>

</tool-use>

---

<think><details><summary>Thought Process</summary>
All files have been created and updated. Let me verify by reading the lints to make sure there are no issues.</details></think>

---

Let me verify the changes.

---

<tool-use data-tool-type="unknown" data-tool-name="read_lints">
<details>
<summary>Tool use: **read_lints**</summary>


Parameters:

```json
{
  "paths": [
    "/Users/sharonfrenkel/Dev/hass-generator/src/blueprints/ikea_e2213_base.js",
    "/Users/sharonfrenkel/Dev/hass-generator/src/blueprints/ikea_e2213_dbl_click.js",
    "/Users/sharonfrenkel/Dev/hass-generator/src/blueprints/index.js",
    "/Users/sharonfrenkel/Dev/hass-config/generator.config.js"
  ]
}
```
Result:

```json
{
  "linterErrorsByFile": [
    {
      "relativeWorkspacePath": "/Users/sharonfrenkel/Dev/hass-generator/src/blueprints/ikea_e2213_base.js"
    },
    {
      "relativeWorkspacePath": "/Users/sharonfrenkel/Dev/hass-generator/src/blueprints/ikea_e2213_dbl_click.js"
    },
    {
      "relativeWorkspacePath": "/Users/sharonfrenkel/Dev/hass-generator/src/blueprints/index.js"
    },
    {
      "relativeWorkspacePath": "/Users/sharonfrenkel/Dev/hass-config/generator.config.js"
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
All lints pass. Let me summarize what was done.</details></think>

---

Done. Here's what I created:

**New blueprint files:**

1. **`ikea_e2213_base.js`** - Base template for SOMRIG shortcut button:
   - dots1 (1 dot): short=on, long=brightness up (with loop)
   - dots2 (2 dots): short=off, long=brightness down (with loop)

2. **`ikea_e2213_dbl_click.js`** - Extended template with double-click:
   - All base functionality plus:
   - dots1 double-click: max brightness (100%)
   - dots2 double-click: min brightness (1%)

**Updated files:**

3. **`blueprints/index.js`** - Added exports for `ikeaE2213Base` and `ikeaE2213DblClick`

4. **`generator.config.js`** - Added imports for the new blueprints

The `synced-entities.js` already handles blueprints generically via the `blueprint` property, so no changes were needed there.

**Usage example** in `generator.config.js`:

```javascript
{
  device_id: 'your_somrig_device_id',
  sync: false,
  blueprint: ikeaE2213DblClick('light.your_light_entity'),
}
```

---

